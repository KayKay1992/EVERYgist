PUBLISH OR SAVE BLOG POST TO DRAFT - IMPLEMENTATION GUIDE
==========================================================

OVERVIEW:
This feature allows users to either publish a blog post immediately or save it as a draft for later completion. It includes comprehensive validation, image upload handling, and different flows for creating new posts vs. editing existing ones.

STEP-BY-STEP IMPLEMENTATION:

1. FRONTEND HANDLER (BlogPostEditor.jsx - handlePublish function)

   Function Signature: handlePublish(isDraft)
   - isDraft: boolean parameter (true = save as draft, false = publish)

   a) Validation Logic:
      
      ALWAYS REQUIRED (Draft or Published):
      - Title must not be empty
      - Content must not be empty
      
      ONLY REQUIRED FOR PUBLISHING (isDraft = false):
      - Cover image validation:
        * For new posts: postData.coverImageUrl must exist
        * For editing: either coverImageUrl OR coverPreview must exist
      - Tags validation:
        * Must be an array
        * Must contain at least one tag
        * Check: !postData.tags || !Array.isArray(postData.tags) || postData.tags.length === 0

   b) Image Upload Handling:
      - Checks if coverImageUrl is a File object (new upload)
      - If yes: calls uploadImage() to upload to server
      - If no: uses existing coverPreview URL
      - Stores result in coverImageUrl variable

   c) Request Payload:
      {
        title: postData.title,
        content: postData.content,
        coverImageUrl,
        tags: postData.tags,
        isDraft: isDraft ? true : false,
        generatedByAI: true,
      }

   d) API Call:
      - Edit mode: PUT request to API_PATHS.POSTS.UPDATE(postData.id)
      - Create mode: POST request to API_PATHS.POSTS.CREATE_POST
      - Uses axiosInstance for authentication

   e) Success Handling:
      - Shows success toast with appropriate message:
        * "Blog post saved as draft!" (isDraft = true)
        * "Blog post updated successfully!" (isEdit = true)
        * "Blog post published successfully!" (new post published)
      - Navigates to /admin/posts page

   f) Error Handling:
      - Catches server errors
      - Displays server error message if available
      - Shows generic fallback: "Failed to publish post. Please try again."
      - Always resets loading state in finally block

2. BACKEND API - CREATE POST (blogPostController.js)

   Endpoint: POST /api/posts
   Access: Admin only

   Process:
   - Extracts: title, content, tags, coverImageUrl, isDraft, generatedByAI
   - Generates slug from title:
     * Converts to lowercase
     * Replaces spaces with hyphens
     * Removes non-word characters
   - Creates new BlogPost document:
     * Includes all extracted fields
     * Adds slug
     * Sets author to req.user._id (from auth middleware)
   - Saves to database
   - Returns 201 status with new post object

3. BACKEND API - UPDATE POST (blogPostController.js)

   Endpoint: PUT /api/posts/:id
   Access: Admin only (must be post author)

   Process:
   - Finds post by ID
   - Returns 404 if not found
   - Checks authorization (post.author === req.user._id)
   - Returns 403 if not authorized
   - If title changed: regenerates slug
   - Updates post with new data using findByIdAndUpdate
   - Returns 200 status with updated post object

4. HELPER UTILITIES

   a) Toast Messages (helper.js - getToastMessageByType):
      - 'edit': "Blog post updated successfully!"
      - 'draft': "Blog post saved as draft!"
      - 'published': "Blog post published successfully!"
      - default: "Blog post saved successfully!"

   b) Image Upload (uploadImage.js):
      - Creates FormData with image file
      - POSTs to API_PATHS.IMAGE.UPLOAD_IMAGE
      - Sets Content-Type: multipart/form-data
      - Returns response.data containing imageUrl

5. UI INTEGRATION

   a) Two Action Buttons:
      
      Save as Draft Button:
      - Text: "Save as Draft"
      - Icon: LuSave
      - onClick: () => handlePublish(true)
      - Allows saving without cover image or tags
      
      Publish Button:
      - Text: "Publish Post" (new) or "Update & Publish" (edit)
      - Icon: LuSend (or LuLoaderCircle when loading)
      - onClick: () => handlePublish(false)
      - Requires all validation to pass

   b) Loading State:
      - Buttons disabled during API call
      - Spinner shows on publish button
      - Prevents duplicate submissions

   c) Error Display:
      - Shows validation errors above form
      - Red text for visibility
      - Clears on successful submission

6. DATA MODEL (BlogPost Schema)

   Fields:
   - title: String (required)
   - content: String (required)
   - slug: String (unique, generated from title)
   - coverImageUrl: String
   - tags: Array of strings
   - isDraft: Boolean (default: false)
   - generatedByAI: Boolean (default: false)
   - author: ObjectId (ref: User)
   - timestamps: createdAt, updatedAt

7. VALIDATION RULES SUMMARY

   For Draft (isDraft = true):
   ✓ Title required
   ✓ Content required
   ✗ Cover image optional
   ✗ Tags optional

   For Publishing (isDraft = false):
   ✓ Title required
   ✓ Content required
   ✓ Cover image required
   ✓ At least one tag required

8. KEY FEATURES

   a) Dual Mode Operation:
      - Single function handles both draft and publish
      - Different validation based on isDraft flag
      - Flexible for user workflow

   b) Edit vs Create:
      - Same handler for both operations
      - Automatically detects via isEdit prop
      - Different API endpoints based on mode

   c) Smart Image Handling:
      - Checks if new image uploaded (File instance)
      - Reuses existing URL if no new upload
      - Handles both new posts and edits

   d) Slug Generation:
      - Automatic URL-friendly slug from title
      - Regenerated on title updates
      - Ensures SEO-friendly URLs

   e) User Feedback:
      - Context-aware toast messages
      - Clear error messages
      - Loading indicators

9. TECHNICAL BENEFITS

   - Single source of truth for publish logic
   - Comprehensive validation prevents bad data
   - Proper error handling at all levels
   - Clean separation of concerns (frontend/backend)
   - Reusable across create and edit modes
   - Type-safe image upload detection
   - Automatic navigation after success

10. POTENTIAL ENHANCEMENTS

   - Auto-save drafts periodically
   - Preview mode before publishing
   - Schedule posts for future publishing
   - Version history for edits
   - Bulk draft management
   - Publish directly from draft list
   - Validation warnings (not blockers)
   - SEO score checker before publish
   - Social media preview generator
   - Duplicate post detection