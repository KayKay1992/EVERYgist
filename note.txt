Creating Comments APIs (Add delete get comments)

===============================================================================
Comments APIs Implementation Explanation
Generated: November 6, 2025
===============================================================================

Overview
- You added a full comments feature with endpoints to create (including replies),
	list (by post and globally), and delete comments with proper auth checks.

Files involved
- backend/models/Comment.js — Mongoose schema (post, author, content, parentComment, timestamps)
- backend/controllers/commentController.js — Business logic (implemented now)
- backend/routes/commentRoutes.js — Route definitions and protection
- backend/server.js — Mounts /api/comments

Endpoints
1) POST /api/comments/:postId  (Protected)
	 - Body: { content: string, parentComment?: commentId }
	 - Creates a top-level comment on a post, or a reply when parentComment is provided.
	 - Validates content, verifies post exists, checks parent comment for replies.
	 - Response: 201 with the created comment populated with author { name, profileImageUrl }.

2) GET /api/comments/:postId  (Public)
	 - Returns all comments for a post, newest first.
	 - Populates author { name, profileImageUrl }.

3) GET /api/comments  (Public; consider admin-only later)
	 - Query params: page (default 1), limit (default 20)
	 - Returns paginated comments across all posts with author and post { title, slug }.

4) DELETE /api/comments/:commentId  (Protected)
	 - Only the comment author or an admin can delete.
	 - Response: { message: "Comment deleted" }

Controller logic (backend/controllers/commentController.js)
- addComment:
	* Validates required content.
	* Verifies BlogPost existence and parent comment when replying.
	* Creates the comment with post, author (from req.user), content, and optional parentComment.
	* Returns the new comment populated with author profile.

- getCommentsByPost:
	* Finds comments for a given post and sorts by createdAt desc.
	* Populates author profile basics.

- getAllComments:
	* Paginates all comments, sorts newest first, and populates author and post summary.
	* Response payload includes comments, page, totalPages, and total count.

- deleteComment:
	* Ensures comment exists, then checks ownership (req.user._id) or admin role.
	* Deletes and responds with a success message.

Routes (backend/routes/commentRoutes.js)
- POST   /:postId        → protect → addComment
- GET    /:postId        → getCommentsByPost
- GET    /               → getAllComments
- DELETE /:commentId     → protect → deleteComment

Auth & permissions
- Creation and deletion require JWT (protect middleware). Listing is public.
- Delete is restricted to the comment author or an admin user.

Notes & improvements
- Consider adding pagination to GET /api/comments/:postId and nested thread fetching.
- Add soft-delete (isDeleted flag) and edit history (isEdited/editedAt) for UX.
- Add rate limiting and content length validation to prevent abuse.
- Extend queries to return top-level comments and thread replies separately if needed.

Status
- Controllers implemented, routes wired, and server mounts /api/comments. Ready to test.
===============================================================================